# SymbolField Graph–Node System — Unified Spec (v0.32)

Упрощённая, очищенная, финально выровненная версия.\
Единая логика нод, жестов, свойств и компонентов.&#x20;

---

# 1. Онтология ноды

**Node = Entity + Components + State**

### Entity (форма)

Содержимое ноды — текст, медиа, звук, таблица, граф, вложенный патч.

### Components (функции)

Подключаемые модули:

- glyph
- tone
- xp
- temporal
- process
- ritual

### State (состояние)

Активность, выделение, режим deep/flow/luma, реакция на Tone.

Никаких типов нод. Любая нода становится функциональной через включение компонентов.

---

# 1.1. Core‑нода

Единственная нода, рождающаяся из **Source**.\
Определяет «центр гравитации» патча.

Имеет по умолчанию:

- пустой контейнер + поддержка вложенного графа
- базовый глиф ядра
- наследованный Tone
- XP=0 по всем осям
- Temporal = NOW
- особое свойство: Core усиливает XP и Tone подключённых нод

Core не удаляется. Сброс — через Reset Patch.

---

# 2. UX‑логика создания и взаимодействия нод

Принципы: быстрое создание, глубокая работа, минимальный набор жестов.

## 3.1. Создание нод

### Base:

- **Double‑click** на Canvas → создать ноду.
- **Single‑click** по ноде → открыть Properties Panel.
- **Double‑click** по ноде → войти внутрь (редактор / вложенный патч).
- **Right‑click / long‑press** → радиальное меню.
- **Shift + Drag** от края ноды → создать новую ноду + связь.
- **Drag‑connect** → соединить через порт.
- Shift + edge‑click → редактировать связь.
- Hover → Info Panel.
- Backspace → удалить.

### Core‑нода:

Source появляется один раз → клик → превращается в Core.

---

## 3.2. Радиальное меню (минимальное)

Только действия, никаких свойств.

- ↑ **Clone**
- → **Convert** (пресеты нод)
- ↓ **Delete**

---

## 3.3. Контекстное глубокое меню (облегчённое)

Только редкие мутации и дев‑режимы:

- Convert to Subpatch
- Ritual ON/OFF
- Process ON/OFF

## 3.4. Добавление компонентов

Компоненты добавляются по мере необходимости через кнопку в properties panel:

```
[ + Add Component ]
```

Компонент после выбора появляется как отдельная секция в Properties Panel.

### Базовые:

- **GlyphComponent** — символ ноды.
- **ToneComponent** — цвет/настроение.
- **XPComponent** — стихийный вектор (HP/EP/MP/SP/NP).
- **RelationComponent** — структура связей.

### Расширенные:

- **ProcessComponent** — фильтры/морфинг/трансформации.
- **TemporalComponent** — связь с Time Spiral.
- **RitualComponent** — дыхание, пульсация, глиф‑мутации.

## 3.5. Поведение нод

- Glow = функция XP + Tone + Mode.
- Радиус свечения = `sqrt(xp) * modeCoefficient`.
- Tone задаёт акценты и дыхание.
- Glyph меняет визуальный стиль.
- TemporalComponent влияет на ореол.

## 3.6. Удаление

- ↓ Delete в радиалке
- Backspace
- Core не удаляется

---

# 4. XPComponent

XP — энергетический вектор ноды:

- **HP** — тело / земля
- **EP** — эмоции / вода
- **MP** — логика / огонь
- **SP** — дух / воздух
- **NP** — порог / пустота

### Функции:

- даёт ноде вес
- влияет на свечение и паттерн
- связывает со стихией
- усиливает Core при прямом подключении
- участвует в расчёте игрового опыта

### Визуализация:

- тонкое спектральное кольцо
- сила свечения = sqrt(xp)
- радиус = xp × модовый коэффициент
- паттерн = глиф стихии

---

# 5. Time Spiral × Graph

TemporalComponent привязывает ноду к масштабу времени.

- day → локальный уровень
- week → включает day
- month → включает week
- year → включает month
- 3y, 7y, 12y → расширенные уровни

Переключение масштаба меняет глубину отображения.

---

# 6. Режимы Deep / Flow / Luma

Влияют только на визуальный слой.

### Deep

- тонкие линии
- минимальный glow
- высокий контраст

### Flow

- дыхание
- мягкость линий
- кристалличный glow

### Luma

- инверсия
- тёплый свет
- адаптивный контраст

### Ritual Mode

- дыхание, мутация глифов, XP‑волны



# 7. Мини‑ТЗ для разработки (v0.32)

1. Базовая структура ноды.
2. Double‑click = создание.
3. Source → Core.
4. Мини‑радиалка: Clone / Convert / Delete.
5. Add Component через «+».
6. Базовые компоненты: glyph, tone, xp.
7. Расширенные: process, temporal, ritual.
8. Модель связей.
9. Режимы Deep / Flow / Luma.
10. Time Spiral фильтрация.
11. Вложенные патчи

