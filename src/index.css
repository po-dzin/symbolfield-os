@import "tailwindcss";
@config "../tailwind.config.js";

:root {
    font-family: Inter, system-ui, Avenir, Helvetica, Arial, sans-serif;
    line-height: 1.5;
    font-weight: 400;

    color-scheme: dark;

    /* Default (Deep/Flow) - Dark Mode */
    --text-primary: #FFFFFF;
    --text-secondary: #B4B9C1;
    --text-meta: #6B7280;

    /* Harmonic Typography Scale (v0.1) */
    --text-base: 16px;
    --text-sub: 18px;
    --text-head: 24px;

    /* Theme Colors (Tailwind map) */
    --color-os-dark: #0a0a0c;

    color: var(--text-primary);
    background-color: var(--color-os-dark);

    /* Layout System (v0.5) */
    --panel-width-sm: 280px;
    --panel-width-md: 320px;
    --panel-width-lg: 360px;
    --panel-radius: 24px;
    --panel-padding: 24px;
    --bar-height: 56px;
    --bar-pad-y: 12px;
    --bar-pad-x: 20px;
    --bar-gap: 12px;
    --bar-icon: 20px;
    --dock-width: 56px;
    --control-size: 32px;
    --layout-step: 8px;

    /* Glass surfaces */
    --glass-bg: rgba(10, 10, 14, 0.78);
    --glass-border: rgba(255, 255, 255, 0.1);
    --glass-blur: 22px;
    --glass-grain-opacity: 0.08;
    --glass-grain: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='80' height='80' filter='url(%23n)' opacity='0.25'/%3E%3C/svg%3E");
    --bar-bg: rgba(10, 10, 14, 0.7);
    --bar-border: rgba(255, 255, 255, 0.08);

    /* Disable text selection globally */
    user-select: none;
    -webkit-user-select: none;

    /* Z-Index Hierarchy (v0.5) */
    --z-background: 0;
    --z-canvas: 10;
    --z-ui: 100;
    --z-hud: 200;
    --z-drawer: 300;
    --z-overlay: 1000;
}

body {
    margin: 0;
    min-width: 320px;
    min-height: 100vh;
    background: radial-gradient(circle at 50% 50%, #1a1a24 0%, #0a0a0c 100%);
    overflow: hidden;
    overscroll-behavior: none;
    overscroll-behavior-x: none;
    touch-action: none;
}

html, #root {
    overscroll-behavior: none;
    overscroll-behavior-x: none;
    touch-action: none;
}

/* --- Crystal OS Core Animations --- */

@keyframes breathe {

    0%,
    100% {
        transform: scale(1);
        filter: brightness(1) drop-shadow(0 0 12px rgba(255, 255, 255, 0.2));
    }

    50% {
        transform: scale(1.05);
        filter: brightness(1.2) drop-shadow(0 0 20px rgba(255, 255, 255, 0.4));
    }
}

@keyframes orbit-spin {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

@layer components {
    .glass-panel {
        @apply border rounded-[var(--panel-radius)];
        position: relative;
        background: var(--glass-bg);
        border-color: var(--glass-border);
        backdrop-filter: blur(var(--glass-blur));
        -webkit-backdrop-filter: blur(var(--glass-blur));
        overflow: hidden;
    }

    .glass-panel-strong {
        background: rgba(10, 10, 14, 0.88);
        border-color: rgba(255, 255, 255, 0.12);
    }

    .glass-panel::before {
        content: "";
        position: absolute;
        inset: 0;
        background-image: var(--glass-grain);
        opacity: var(--glass-grain-opacity);
        pointer-events: none;
        z-index: 0;
    }

    .glass-panel > * {
        position: relative;
        z-index: 1;
    }

    .topbar-shell {
        @apply flex items-center w-full;
        height: var(--bar-height);
        padding: var(--bar-pad-y) var(--bar-pad-x);
        gap: var(--bar-gap);
        background: var(--bar-bg);
        border-bottom: 1px solid var(--bar-border);
        backdrop-filter: blur(var(--glass-blur));
        -webkit-backdrop-filter: blur(var(--glass-blur));
        position: relative;
        overflow: visible;
    }

    .topbar-shell::before {
        content: "";
        position: absolute;
        inset: 0;
        background-image: var(--glass-grain);
        opacity: var(--glass-grain-opacity);
        pointer-events: none;
        z-index: 0;
    }

    .topbar-shell > * {
        position: relative;
        z-index: 1;
    }
}

.glyph-icon svg {
    display: block;
}

.context-toolbar {
    cursor: pointer !important;
}

.context-toolbar button {
    cursor: pointer !important;
}

.context-toolbar,
.context-toolbar * {
    cursor: pointer !important;
}

.context-toolbar input,
.context-toolbar textarea {
    cursor: text !important;
}

button,
[role="button"],
[data-clickable="true"] {
    cursor: pointer;
}

[data-context-menu],
[data-context-menu] * {
    cursor: pointer;
}

[data-context-menu] input,
[data-context-menu] textarea {
    cursor: text;
}

input,
textarea,
[contenteditable="true"] {
    cursor: text;
}

@keyframes cloud-bloom {
    0% {
        opacity: 0.35;
        transform: scale(0.98);
    }

    50% {
        opacity: 0.14;
        transform: scale(1.05);
    }

    100% {
        opacity: 0.35;
        transform: scale(0.98);
    }
}

@keyframes ring-shift {
    0% {
        transform: scale(0.98);
        opacity: 0.32;
    }

    50% {
        transform: scale(1.02);
        opacity: 0.16;
    }

    100% {
        transform: scale(0.98);
        opacity: 0.32;
    }
}

.camera-smooth {
    transition: transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
}

.undo-smooth [data-node-id] {
    transition: transform 0.3s cubic-bezier(0.22, 1, 0.36, 1);
}

/* Utilities */
.animate-breathe {
    animation: breathe 4s ease-in-out infinite;
}

.animate-orbit-slow {
    animation: orbit-spin 20s linear infinite;
}

.animate-orbit-reverse {
    animation: orbit-spin 15s linear infinite reverse;
}

/* Standard orbit if used */
.animate-orbit {
    animation: orbit-spin 30s linear infinite;
}

.orbit-sector {
    position: absolute;
    inset: -14px;
    border-radius: 50%;
    pointer-events: none;
    background: conic-gradient(from var(--sector-angle),
            rgba(255, 255, 255, 0.55) 0deg,
            rgba(255, 255, 255, 0.15) 36deg,
            transparent 85deg,
            transparent 360deg);
    filter: blur(0.6px) drop-shadow(0 0 10px rgba(255, 255, 255, 0.35));
    -webkit-mask: radial-gradient(circle, transparent 68%, #000 69%, #000 72%, transparent 73%);
    mask: radial-gradient(circle, transparent 68%, #000 69%, #000 72%, transparent 73%);
}

.orbit-sector-1 {
    --sector-angle: 8deg;
    animation: orbit-spin 12s linear infinite reverse;
}

.orbit-sector-2 {
    inset: -20px;
    animation: orbit-spin 18s linear infinite reverse;
    opacity: 0.7;
    --sector-angle: 188deg;
}


.root-dot-cloud {
    position: absolute;
    inset: -35%;
    border-radius: 50%;
    pointer-events: none;
    background-image:
        radial-gradient(circle at 50% 50%,
            rgba(255, 220, 170, 0.42) 0%,
            rgba(255, 220, 170, 0.22) 36%,
            rgba(255, 220, 170, 0.1) 62%,
            rgba(255, 220, 170, 0) 78%),
        radial-gradient(circle, rgba(255, 220, 170, 0.42) 1px, transparent 1px),
        radial-gradient(circle, rgba(255, 220, 170, 0.2) 1px, transparent 1px);
    background-size: 100% 100%, 6px 6px, 10px 10px;
    background-position: center, 0px 2px, 4px 0px;
    background-blend-mode: screen;
    -webkit-mask-image: radial-gradient(circle,
            transparent 0%,
            transparent 44%,
            rgba(0, 0, 0, 0.95) 46%,
            rgba(0, 0, 0, 0.65) 74%,
            rgba(0, 0, 0, 0.2) 88%,
            rgba(0, 0, 0, 0) 100%);
    mask-image: radial-gradient(circle,
            transparent 0%,
            transparent 44%,
            rgba(0, 0, 0, 0.95) 46%,
            rgba(0, 0, 0, 0.65) 74%,
            rgba(0, 0, 0, 0.2) 88%,
            rgba(0, 0, 0, 0) 100%);
    animation: ring-shift 48s ease-in-out infinite;
}

.node-hidden {
    opacity: 0;
    transform: scale(1);
    filter: none;
}

.root-node-surface {
    background: radial-gradient(circle at 50% 50%,
            rgba(255, 255, 255, 0.08) 0%,
            rgba(255, 255, 255, 0.05) 62%,
            rgba(255, 255, 255, 0.09) 84%,
            rgba(255, 255, 255, 0.06) 100%);
    box-shadow: 0 0 18px rgba(255, 255, 255, 0.08), inset 0 0 10px rgba(255, 255, 255, 0.06);
}

.root-dot-cloud-1 {
    opacity: 0.35;
}

.root-dot-cloud-2 {
    display: none;
}

@keyframes node-bloom {
    from {
        transform: scale(0.6);
        opacity: 0;
        filter: blur(8px);
    }

    to {
        transform: scale(1);
        opacity: 1;
        filter: blur(0);
    }
}

.animate-bloom {
    animation: node-bloom 0.75s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

@keyframes core-materialize {
    0% {
        transform: scale(0.08);
        opacity: 0;
        filter: blur(10px);
    }

    100% {
        transform: scale(1);
        opacity: 1;
        filter: blur(0);
    }
}

.animate-core-materialize {
    animation: core-materialize 1.2s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    transform-origin: center;
}

@keyframes core-glyph-in {
    0% {
        opacity: 0;
        transform: scale(0.9);
        filter: blur(6px);
    }

    100% {
        opacity: 1;
        transform: scale(1);
        filter: blur(0);
    }
}

.core-glyph-appear {
    opacity: 0;
    animation: core-glyph-in 0.5s ease-out forwards;
    animation-delay: 0.9s;
    transform-origin: center;
}

@keyframes source-pulse-spread {
    0% {
        transform: scale(1);
        opacity: 0.2;
    }

    100% {
        transform: scale(4);
        opacity: 0;
    }
}

@keyframes source-dot-pulse {

    0%,
    100% {
        transform: scale(1);
        opacity: 1;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }

    50% {
        transform: scale(0.9);
        opacity: 0.8;
        box-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
    }
}

.animate-source-pulse-spread {
    animation: source-pulse-spread 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

.animate-source-dot-pulse {
    animation: source-dot-pulse 4s ease-in-out infinite;
}
